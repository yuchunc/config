#!/bin/sh

# This pre-push hook ensures that all Elixir files are properly formatted
# according to `mix format` before allowing a push to proceed.

echo "Running mix format check before push..."

mix deps.get

# Check if all files are properly formatted
if ! mix format --check-formatted 2>/dev/null; then
  echo "❌ Some files are not properly formatted!"
  echo ""
  echo "The following files need formatting:"
  mix format --check-formatted 2>&1 | grep -E "\*\*.*\.(ex|exs)" || true
  echo ""
  echo "Please run 'mix format' to fix formatting issues and try pushing again."
  echo ""
  exit 1
fi

echo "✅ All files are properly formatted!"
echo ""

exit 0

